{% extends 'base.html.twig' %}

{% block title %}Key Performance Indicators QUAESTYO{% endblock %}
{% block stylesheets %}{% endblock %}      
{% block body %}

 <h1 class="text-center">Key Performance Indicators QUAESTYO</h1>
 <div class="text-center">
    <div class="spinner-border text-primary" role="status"></div>  
    <div class="spinner-border text-secondary" role="status"></div>    
    <div class="spinner-border text-success" role="status"></div>     
    <div class="spinner-border text-danger" role="status"></div>     
    <div class="spinner-border text-warning" role="status"></div>    
    <div class="spinner-border text-info" role="status"></div>     
    <div class="spinner-border text-light" role="status"></div>    
    <div class="spinner-border text-dark" role="status"></div>
    <div class="spinner-border text-primary" role="status"></div>  
    <div class="spinner-border text-secondary" role="status"></div>    
    <div class="spinner-border text-success" role="status"></div>     
    <div class="spinner-border text-danger" role="status"></div>     
</div>
<div class="d-grid gap-3">
  <div class="p-5 bg-white"></div>
 <div class="container">
<table class="table table-striped">
  <thead>
    <tr class="table-success">
    <th scope="col">Volumétries Nationales QUAESTYO</th>
    {% for col in vol_cols%}
      <th scope="col">{{col}}</th>
    {% endfor %} 
    <th scope="col">Moyen</th>     
    </tr>    
  </thead>
  <tbody>
    <tr>
      <th scope="row">CAC</th>
      {% for col in cac_data%}
        <th scope="col">{{col}}€</th>
      {% endfor %}
      <th scope="col">{{cac|round(2)}}€</th>
    </tr>
    <tr>
      <th scope="row">ARPU</th>
      {% for col in arpu_data%}
        <th scope="col">{{col}}€</th>
      {% endfor %}
      <th scope="col">{{arpu|round(2)}}€</th>
    </tr>
    <tr>
      <th scope="row">Panier Moyen</th>
      {% for col in pan_moy_data%}
        <th scope="col">{{col}}€</th>
      {% endfor %}
      <th scope="col">{{panier|round(2)}}€</th> 
    </tr>
    <tr>
      <th scope="row">CLTV</th>
      {% for col in cltv_data%}
        <th scope="col">{{col|round(2)}}€</th>
      {% endfor %}
      <th scope="col">{{cltv|round(2)}}€</th> 
    </tr>    
    <tr>
      <th scope="row">Résultat</th>
      {% for col in resultat%}
        <th {% if col<0 %} style="color:red" {% endif %} scope="col">{{col|round(2)}}€</th>
      {% endfor %}
      <th {% if result<0 %} style="color:red" {% endif %}>{{result|round(2)}}€</th> 
    </tr>               
  </tbody>
</table>
    
    <canvas id="volg" width="400" height="100"></canvas>
  <script>    
        let volg = document.querySelector("#volg");
        let volgGraph = new Chart(volg, {
            type: 'bar',
            
    data: {
        labels: {{ vol_cols2 }},
        datasets: [{
            label: 'CAC',
            backgroundColor: 'blue',
            order: 2,
            data: {{ cac_data2 }}       
            
        },{
            label: 'ARPU',
            backgroundColor: 'red',
            order: 2,
            data: {{ arpu_data2 }}
            
        },{
            label: 'CLTV',
            backgroundColor: 'yellow',
            order: 2,
            data: {{ cltv_data2 }}            
        },{
            type: 'line',
            label: 'Résultat Moyen',
            borderColor: 'orange',
            order: 1,
            data: {{ result2 }}            
        },{
            type: 'line',
            label: 'Résultat',
            borderColor: 'green',            
            order: 1,
            data: {{ resultat2 }}
        
            
        }]
    },
    options: {
        plugins: {
            legend: {
                display: true,
                position: 'bottom',
            },
            title: {
                display: true,
                text: "Volumétries Nationales QUAESTYO" 
            }
        },
        scales: {
            y: {
                beginAtZero: true
            },
            x: {
                
                //type: 'category',
                //labels: {{ vol_cols2 }}
            }
        }
    }
});

    </script>    

</div>
{% endblock %}

{% block javascripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.2.1/chart.js" integrity="sha512-or2Rj8rtp6G4AA7LOM1DVfQmzsevkILKgY1LLJ5kEDv3UCiEt9bmHJn7LNmo8BC5hxJCQ3cosqo1t77+p/yOfg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    
    
{% endblock %}